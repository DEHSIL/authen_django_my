{% extends 'base.html' %}

{% load cart_filters %}

{% load static %}

{% block title %}
    {{ product.name }}
{% endblock %}

{% block cart_total %}
{{ cart_len }}
{% endblock %}

{% block con %}
    <div class="d-flex">
        <div class="shadow-sm bg-body rounded rounded-2 border border-light border-2 btn-light justify-content-center align-itemss-center" style="height: 500px; width: 500px;">
            <img class="rounded rounded-2"  style="height: 500px; width: 500px; object-fit: contain; padding: 2px;"  src="{{ product.image.url }}" alt="">
        </div>
        <div class="ms-5 d-flex" style="flex-direction: column;">
            <h2  style="width: 500px; height: 90px; margin-bottom: 0; font-size: 70px; display: -webkit-box; -webkit-line-clamp: 3;-webkit-box-orient: vertical;overflow: hidden;">{{ product.name }}</h2>
            <hr>
            <div class="d-flex align-items-center justify-content-between">
                <h3 style="color: rgb(13, 110, 253);">{{ product.price }} Тнг.</h3>
                {% if user.is_authenticated %}
                <a class=" me-3" href="{% url 'add_to_favorites' product.id %}" style="height: 50px; width: 50px;">
                    {% if favorite_items %} 
                    <img src="{% static 'img/heart_blue.png' %}" alt="">
                    {% else %}
                    <img src="{% static 'img/heart.png' %}" alt="">
                    {% endif %}
                </a>
                {% endif %}
            </div>
                <br>
                <br>
            <p style="flex: 1 1 auto; font-size: 20px; width: 550px; font-weight: 200; overflow-wrap: break-word; display: -webkit-box; -webkit-box-orient: vertical;overflow: hidden; line-height: 160%; color: rgb(104, 103, 103);">{{product.description}}</p>
            {% if user.is_authenticated %}
            <div class="d-flex justify-content-around text-center align-items-center" style="background-color: rgb(212, 220, 244); border-radius: 10px; padding: 4px;">
                    {% if cart_item %}    
                        <a style="text-decoration: none; width: 30px; padding: 3px; font-weight: 700; font-size: 25px;" href="{% url 'remove_from_cart' cart_item.0.id %}">-</a> 
                        <span>{{ cart_item|cart_quantity:product }}</span>
                        <a style="text-decoration: none; width: 30px; padding: 3px; font-weight: 700; font-size: 20px;" href="{% url 'add_to_cart' product.id %}">+</a>  
                    {% else %}  
                        <a style=" text-decoration: none;  padding: 9px; font-weight: 600; font-size: 17px;" href="{% url 'add_to_cart' product.id %}">Добавить в корзину</a>
                    {% endif %} 
            </div>
            {% endif %}
        </div>
    </div>
    <br>
    <hr>
    <div style="margin: 0 100px;">
        <h2 class="text-center">Комментарии</h2>
        <br>
        <div class="d-flex justify-content-between">
            <div class="">
            {% for comment in comments %}
                <div style="width: 450px;" class="mt-2 shadow-sm p-3 bg-body rounded rounded-2 border border-light border-2 btn-light ">
                    <p style="width: 400px; overflow-wrap: break-word; display: -webkit-box; -webkit-box-orient: vertical;overflow: hidden; line-height: 160%;">{{ comment.text }}</p>
                    <div class="">
                        <span style="font-size: 14px;">{{ comment.user }}</span>
                        <span class="ms-2" style="font-size: 13px; color: rgb(13, 110, 253);" >{{ comment.created_at }}</span>
                    </div>
                </div>
                <br>
            {% endfor %}
            </div>
            {% if user.is_authenticated %}
            <div class="">
                <h3 >Добавить комментарий</h3>
                <form method="post">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <button type="submit" class="btn btn-outline-primary">Отправить</button>
                </form>
            </div>
            {% else %}
                <h5>Войдите что бы остваить комментарии</h5>
            {% endif %}
        </div>
    </div>
{% endblock con %}